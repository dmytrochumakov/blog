<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>LeetCode - Blind 75 - Counting Bits | Dmytro&#39;s Blog</title>
<meta name="keywords" content="LeetCode, Blind 75, Counting Bits, Swift">
<meta name="description" content="The problem
Given an integer n, return an array ans of length n &#43; 1 such that for each i (0 &lt;= i &lt;= n), ans[i] is the number of 1s in the binary representation of i.
Examples
Input: n = 2  
Output: [0,1,1]  
Explanation:  
0 --&gt; 0  
1 --&gt; 1  
2 --&gt; 10  
Input: n = 5  
Output: [0,1,1,2,1,2]  
Explanation:  
0 --&gt; 0  
1 --&gt; 1  
2 --&gt; 10  
3 --&gt; 11  
4 --&gt; 100  
5 --&gt; 101  
Constraints

0 &lt;= n &lt;= 10^5

Follow up:">
<meta name="author" content="Dmytro Chumakov">
<link rel="canonical" href="http://localhost:1313/posts/leetcode-blind-75-counting-bits/">
<meta name="google-site-verification" content="G-HZZ4JTFGDP">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8d4df4fe329d2372424d28ce76581b7279a2220496c292d225bde1c201d0518c.css" integrity="sha256-jU30/jKdI3JCTSjOdlgbcnmiIgSWwpLSJb3hwgHQUYw=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/leetcode-blind-75-counting-bits/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><style>
    @media screen and (min-width: 769px) {
         
        .post-content input[type="checkbox"]:checked ~ label > img {
            transform: scale(1.6);
            cursor: zoom-out;
            position: relative;
            z-index: 999;
        }
    
        .post-content img.zoomCheck {
            transition: transform 0.15s ease;
            z-index: 999;
            cursor: zoom-in;
        }
    }
    </style>
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-HZZ4JTFGDP"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-HZZ4JTFGDP');
        }
      </script><meta property="og:url" content="http://localhost:1313/posts/leetcode-blind-75-counting-bits/">
  <meta property="og:site_name" content="Dmytro&#39;s Blog">
  <meta property="og:title" content="LeetCode - Blind 75 - Counting Bits">
  <meta property="og:description" content="The problem Given an integer n, return an array ans of length n &#43; 1 such that for each i (0 &lt;= i &lt;= n), ans[i] is the number of 1s in the binary representation of i.
Examples Input: n = 2 Output: [0,1,1] Explanation: 0 --&gt; 0 1 --&gt; 1 2 --&gt; 10 Input: n = 5 Output: [0,1,1,2,1,2] Explanation: 0 --&gt; 0 1 --&gt; 1 2 --&gt; 10 3 --&gt; 11 4 --&gt; 100 5 --&gt; 101 Constraints 0 &lt;= n &lt;= 10^5 Follow up:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-08T07:47:53+03:00">
    <meta property="article:modified_time" content="2025-05-08T07:47:53+03:00">
    <meta property="article:tag" content="LeetCode">
    <meta property="article:tag" content="Blind 75">
    <meta property="article:tag" content="Counting Bits">
    <meta property="article:tag" content="Swift">
      <meta property="og:image" content="http://localhost:1313/images/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/papermod-cover.png">
<meta name="twitter:title" content="LeetCode - Blind 75 - Counting Bits">
<meta name="twitter:description" content="The problem
Given an integer n, return an array ans of length n &#43; 1 such that for each i (0 &lt;= i &lt;= n), ans[i] is the number of 1s in the binary representation of i.
Examples
Input: n = 2  
Output: [0,1,1]  
Explanation:  
0 --&gt; 0  
1 --&gt; 1  
2 --&gt; 10  
Input: n = 5  
Output: [0,1,1,2,1,2]  
Explanation:  
0 --&gt; 0  
1 --&gt; 1  
2 --&gt; 10  
3 --&gt; 11  
4 --&gt; 100  
5 --&gt; 101  
Constraints

0 &lt;= n &lt;= 10^5

Follow up:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "LeetCode - Blind 75 - Counting Bits",
      "item": "http://localhost:1313/posts/leetcode-blind-75-counting-bits/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "LeetCode - Blind 75 - Counting Bits",
  "name": "LeetCode - Blind 75 - Counting Bits",
  "description": "The problem Given an integer n, return an array ans of length n + 1 such that for each i (0 \u0026lt;= i \u0026lt;= n), ans[i] is the number of 1s in the binary representation of i.\nExamples Input: n = 2 Output: [0,1,1] Explanation: 0 --\u0026gt; 0 1 --\u0026gt; 1 2 --\u0026gt; 10 Input: n = 5 Output: [0,1,1,2,1,2] Explanation: 0 --\u0026gt; 0 1 --\u0026gt; 1 2 --\u0026gt; 10 3 --\u0026gt; 11 4 --\u0026gt; 100 5 --\u0026gt; 101 Constraints 0 \u0026lt;= n \u0026lt;= 10^5 Follow up:\n",
  "keywords": [
    "LeetCode", "Blind 75", "Counting Bits", "Swift"
  ],
  "articleBody": "The problem Given an integer n, return an array ans of length n + 1 such that for each i (0 \u003c= i \u003c= n), ans[i] is the number of 1s in the binary representation of i.\nExamples Input: n = 2 Output: [0,1,1] Explanation: 0 --\u003e 0 1 --\u003e 1 2 --\u003e 10 Input: n = 5 Output: [0,1,1,2,1,2] Explanation: 0 --\u003e 0 1 --\u003e 1 2 --\u003e 10 3 --\u003e 11 4 --\u003e 100 5 --\u003e 101 Constraints 0 \u003c= n \u003c= 10^5 Follow up:\nIt is very easy to come up with a solution with a runtime of O(n log n). Can you do it in linear time O(n) and possibly in a single pass? Can you do it without using any built-in function (i.e., like __builtin_popcount in C++)? Explanation Before jumping into the solution, let’s take a look at an example with input n = 2 and how we can count bits.\nWhen we start counting, we can see that we have three values: 0, 1, 2.\nValue 0 has no leading 1s in binary representation Value 1 has only one 1 bit Value 2 also has only one 1 bit As a result, we return an array with [0, 1, 1].\nBit Manipulation - I Solution func countBits(_ n: Int) -\u003e [Int] { var res: [Int] = [] for num in 0 ..\u003c n + 1 { var one = 0 for i in 0 ..\u003c 32 { if ((num \u0026 (1 \u003c\u003c i)) != 0) { one += 1 } } res.append(one) } return res } Explanation Now let’s change our input to 3 -\u003e 011, and find the way we can count multiple 1s.\nWe are going to use \u0026 operator, which will help us determine if the current bit is equal to 1.\nWe will also be using the \u003c\u003c shift operator to the right. This way, we can cross out the current bit and find the rest of the bits.\nTime/Space complexity Time complexity: O(n*logn) Space complexity: O(1) extra space, O(n) space for the output array Bit Manipulation (DP) Solution func countBits(_ n: Int) -\u003e [Int] { var dp = Array(repeating: 0, count: n + 1) var offset = 1 for i in 1 ..\u003c n + 1 { if offset * 2 == i { offset = i } dp[i] = 1 + dp[i - offset] } return dp } Explanation Let’s look at the binary representation of 8:\nWe know that 0 has zero 1s in binary representation.\nWhen we get to 1, we have one occurrence of 1 For binary representation of 2, we have one For binary representation of 3, we have two different 1s When you get to value 4, you start to notice how we are doing repetitive work.\nYou can see that for the values from 4 to 7, the first two bits repeat the previous four values that we calculated.\nSo when we want to get the value of 4, we can take the binary representation of 0 and add 1 to its third bit.\nIf you want to get the value of 5, you can take the binary representation of 1 and add a 1 bit to the third bit.\nYou can see that when we calculate how many 1s are in the binary representation of 4, we just say 1 + dp[0] or 1 + dp[n - 4]. This is a dynamic problem because we are using previous results that we calculated to compute the new results.\nWhen we get to the binary representation of 8, our offset is no longer four, because now the binary representation of 8 represents integer 0. So we want to take 8, offset it to eight, which is going to get us to zero.\nFor each value, we are going to have the equation 1 + dp[n - offset], where offset is the most significant bit we have reached so far.\nThe most significant bit is going to be [1, 2, 4, 8, 16, …]. Basically, it doubles in size. We also know that each bit is a power of two—that’s what binary represents.\nLet’s look at how we can calculate our offset:\nWe know that 0 is our base case and it has zero ones.\nWe know that in the next position of one, we reached the most significant bit of 1, therefore our value will be 1 + dp[n - 1]. At the next position of two, we reached the significant bit of 2, so our value will be 1 + dp[n - 2]. At the next position of three, we again have the most significant bit of 2, so it’s going to use the previous value 1 + dp[n - 2]. When we get to the next element of four, we can see that we reached a new power of two, therefore we will be modifying our offset to 1 + dp[n - 4]. Similarly, when we get to eight, we reach a new power of two, so we are going to do 1 + dp[n - 8]. We can detect that we reached a new power of two by multiplying the previous power of two by 2, and comparing it to the current value we are at.\nTime/Space complexity Time complexity: O(n) Space complexity: O(1) extra space, O(n) space for the output array Thank you for reading! 😊 ",
  "wordCount" : "897",
  "inLanguage": "en",
  "image": "http://localhost:1313/images/papermod-cover.png","datePublished": "2025-05-08T07:47:53+03:00",
  "dateModified": "2025-05-08T07:47:53+03:00",
  "author":{
    "@type": "Person",
    "name": "Dmytro Chumakov"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/leetcode-blind-75-counting-bits/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Dmytro's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Dmytro&#39;s Blog (Alt + H)">Dmytro&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>

        
        <button id="menu-trigger" aria-haspopup="menu" aria-label="Menu Button">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>
        <ul class="menu hidden">
            <li>
                <a href="http://localhost:1313/newsletter/" title="Newsletter">
                    <span>Newsletter</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      LeetCode - Blind 75 - Counting Bits
    </h1>
    <div class="post-meta"><span title='2025-05-08 07:47:53 +0300 EEST'>May 8, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Dmytro Chumakov

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#the-problem" aria-label="The problem">The problem</a><ul>
                        
                <li>
                    <a href="#examples" aria-label="Examples">Examples</a></li>
                <li>
                    <a href="#constraints" aria-label="Constraints">Constraints</a></li>
                <li>
                    <a href="#explanation" aria-label="Explanation">Explanation</a></li></ul>
                </li>
                <li>
                    <a href="#bit-manipulation---i-solution" aria-label="Bit Manipulation - I Solution">Bit Manipulation - I Solution</a><ul>
                        
                <li>
                    <a href="#explanation-1" aria-label="Explanation">Explanation</a></li>
                <li>
                    <a href="#timespace-complexity" aria-label="Time/Space complexity">Time/Space complexity</a></li></ul>
                </li>
                <li>
                    <a href="#bit-manipulation-dp-solution" aria-label="Bit Manipulation (DP) Solution">Bit Manipulation (DP) Solution</a><ul>
                        
                <li>
                    <a href="#explanation-2" aria-label="Explanation">Explanation</a></li>
                <li>
                    <a href="#timespace-complexity-1" aria-label="Time/Space complexity">Time/Space complexity</a></li>
                <li>
                    <a href="#thank-you-for-reading-" aria-label="Thank you for reading! 😊">Thank you for reading! 😊</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h3 id="the-problem">The problem<a hidden class="anchor" aria-hidden="true" href="#the-problem">#</a></h3>
<p>Given an integer <code>n</code>, return an array <code>ans</code> of length <code>n + 1</code> such that for each <code>i</code> (<code>0 &lt;= i &lt;= n</code>), <code>ans[i]</code> is the number of <code>1</code>s in the binary representation of <code>i</code>.</p>
<h4 id="examples">Examples<a hidden class="anchor" aria-hidden="true" href="#examples">#</a></h4>
<pre tabindex="0"><code>Input: n = 2  
Output: [0,1,1]  
Explanation:  
0 --&gt; 0  
1 --&gt; 1  
2 --&gt; 10  
</code></pre><pre tabindex="0"><code>Input: n = 5  
Output: [0,1,1,2,1,2]  
Explanation:  
0 --&gt; 0  
1 --&gt; 1  
2 --&gt; 10  
3 --&gt; 11  
4 --&gt; 100  
5 --&gt; 101  
</code></pre><h4 id="constraints">Constraints<a hidden class="anchor" aria-hidden="true" href="#constraints">#</a></h4>
<ul>
<li>0 &lt;= n &lt;= 10^5</li>
</ul>
<p>Follow up:</p>
<ul>
<li>It is very easy to come up with a solution with a runtime of <code>O(n log n)</code>. Can you do it in linear time <code>O(n)</code> and possibly in a single pass?</li>
<li>Can you do it without using any built-in function (i.e., like <code>__builtin_popcount</code> in C++)?</li>
</ul>
<h4 id="explanation">Explanation<a hidden class="anchor" aria-hidden="true" href="#explanation">#</a></h4>
<p>Before jumping into the solution, let’s take a look at an example with input <code>n = 2</code> and how we can count bits.<br>

    
    <input type="checkbox" id="zoomCheck-f9a0d" hidden>
    <label for="zoomCheck-f9a0d">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="images/338.png#center" alt="alt image" 
             />
    </label>
</p>
<p>When we start counting, we can see that we have three values: <code>0, 1, 2</code>.</p>
<ul>
<li>Value <code>0</code> has no leading <code>1</code>s in binary representation</li>
<li>Value <code>1</code> has only one <code>1</code> bit</li>
<li>Value <code>2</code> also has only one <code>1</code> bit</li>
</ul>
<p>As a result, we return an array with <code>[0, 1, 1]</code>.</p>
<h3 id="bit-manipulation---i-solution">Bit Manipulation - I Solution<a hidden class="anchor" aria-hidden="true" href="#bit-manipulation---i-solution">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">countBits</span><span class="p">(</span><span class="kc">_</span> <span class="n">n</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="p">[</span><span class="nb">Int</span><span class="p">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nv">res</span><span class="p">:</span> <span class="p">[</span><span class="nb">Int</span><span class="p">]</span> <span class="p">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">num</span> <span class="k">in</span> <span class="mi">0</span> <span class="p">..</span><span class="o">&lt;</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nv">one</span> <span class="p">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span> <span class="p">..</span><span class="o">&lt;</span> <span class="mi">32</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">((</span><span class="n">num</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">one</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">one</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="explanation-1">Explanation<a hidden class="anchor" aria-hidden="true" href="#explanation-1">#</a></h4>
<p>Now let’s change our input to <code>3</code> -&gt; <code>011</code>, and find the way we can count multiple <code>1</code>s.<br>

    
    <input type="checkbox" id="zoomCheck-3898c" hidden>
    <label for="zoomCheck-3898c">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="images/338-1.png#center" alt="alt image" 
             />
    </label>
</p>
<p>We are going to use <code>&amp;</code> operator, which will help us determine if the current bit is equal to <code>1</code>.<br>

    
    <input type="checkbox" id="zoomCheck-929c5" hidden>
    <label for="zoomCheck-929c5">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="images/338-2.png#center" alt="alt image" 
             />
    </label>
</p>
<p>We will also be using the <code>&lt;&lt;</code> shift operator to the right. This way, we can cross out the current bit and find the rest of the bits.</p>
<h4 id="timespace-complexity">Time/Space complexity<a hidden class="anchor" aria-hidden="true" href="#timespace-complexity">#</a></h4>
<ul>
<li>Time complexity: O(n*logn)</li>
<li>Space complexity: O(1) extra space, O(n) space for the output array</li>
</ul>
<h3 id="bit-manipulation-dp-solution">Bit Manipulation (DP) Solution<a hidden class="anchor" aria-hidden="true" href="#bit-manipulation-dp-solution">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">countBits</span><span class="p">(</span><span class="kc">_</span> <span class="n">n</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="p">[</span><span class="nb">Int</span><span class="p">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nv">dp</span> <span class="p">=</span> <span class="nb">Array</span><span class="p">(</span><span class="n">repeating</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">count</span><span class="p">:</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nv">offset</span> <span class="p">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span> <span class="p">..</span><span class="o">&lt;</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">offset</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">==</span> <span class="n">i</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">offset</span> <span class="p">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">offset</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dp</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="explanation-2">Explanation<a hidden class="anchor" aria-hidden="true" href="#explanation-2">#</a></h4>
<p>Let’s look at the binary representation of <code>8</code>:<br>

    
    <input type="checkbox" id="zoomCheck-9387f" hidden>
    <label for="zoomCheck-9387f">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="images/338-3.png#center" alt="alt image" 
             />
    </label>
</p>
<p>We know that <code>0</code> has zero <code>1</code>s in binary representation.</p>
<ul>
<li>When we get to <code>1</code>, we have one occurrence of <code>1</code></li>
<li>For binary representation of <code>2</code>, we have one</li>
<li>For binary representation of <code>3</code>, we have two different <code>1</code>s</li>
</ul>
<p>When you get to value <code>4</code>, you start to notice how we are doing repetitive work.<br>
You can see that for the values from <code>4</code> to <code>7</code>, the first two bits repeat the previous four values that we calculated.</p>
<p>So when we want to get the value of <code>4</code>, we can take the binary representation of <code>0</code> and add <code>1</code> to its third bit.<br>
If you want to get the value of <code>5</code>, you can take the binary representation of <code>1</code> and add a <code>1</code> bit to the third bit.</p>
<p>You can see that when we calculate how many <code>1</code>s are in the binary representation of <code>4</code>, we just say <code>1 + dp[0]</code> or <code>1 + dp[n - 4]</code>. This is a dynamic problem because we are using previous results that we calculated to compute the new results.</p>
<p>When we get to the binary representation of <code>8</code>, our offset is no longer <strong>four</strong>, because now the binary representation of <code>8</code> represents integer <code>0</code>. So we want to take <code>8</code>, offset it to <strong>eight</strong>, which is going to get us to <strong>zero</strong>.</p>
<p>For each value, we are going to have the equation <code>1 + dp[n - offset]</code>, where <code>offset</code> is the most significant bit we have reached so far.</p>
<p>The most significant bit is going to be <code>[1, 2, 4, 8, 16, …]</code>. Basically, it doubles in size. We also know that each bit is a <strong>power of two</strong>—that’s what binary represents.<br>
Let’s look at how we can calculate our offset:<br>

    
    <input type="checkbox" id="zoomCheck-ffce1" hidden>
    <label for="zoomCheck-ffce1">
        <img class="zoomCheck" loading="lazy" decoding="async" 
            src="images/338-4.png#center" alt="alt image" 
             />
    </label>
</p>
<p>We know that <code>0</code> is our base case and it has <em>zero ones</em>.</p>
<ul>
<li>We know that in the next position of <em>one</em>, we reached the most significant bit of <code>1</code>, therefore our value will be <code>1 + dp[n - 1]</code>.</li>
<li>At the next position of <em>two</em>, we reached the significant bit of <code>2</code>, so our value will be <code>1 + dp[n - 2]</code>.</li>
<li>At the next position of <em>three</em>, we again have the most significant bit of <code>2</code>, so it’s going to use the previous value <code>1 + dp[n - 2]</code>.</li>
<li>When we get to the next element of <em>four</em>, we can see that we reached a new <strong>power of two</strong>, therefore we will be modifying our <code>offset</code> to <code>1 + dp[n - 4]</code>. Similarly, when we get to <em>eight</em>, we reach a new <strong>power of two</strong>, so we are going to do <code>1 + dp[n - 8]</code>.</li>
</ul>
<p>We can detect that we reached a new <strong>power of two</strong> by multiplying the previous <strong>power of two</strong> by <strong>2</strong>, and comparing it to the current value we are at.</p>
<h4 id="timespace-complexity-1">Time/Space complexity<a hidden class="anchor" aria-hidden="true" href="#timespace-complexity-1">#</a></h4>
<ul>
<li>Time complexity: O(n)</li>
<li>Space complexity: O(1) extra space, O(n) space for the output array</li>
</ul>
<h4 id="thank-you-for-reading-">Thank you for reading! 😊<a hidden class="anchor" aria-hidden="true" href="#thank-you-for-reading-">#</a></h4>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/leetcode/">LeetCode</a></li>
      <li><a href="http://localhost:1313/tags/blind-75/">Blind 75</a></li>
      <li><a href="http://localhost:1313/tags/counting-bits/">Counting Bits</a></li>
      <li><a href="http://localhost:1313/tags/swift/">Swift</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/leetcode-blind-75-reverse-bits/">
    <span class="title">« Prev</span>
    <br>
    <span>LeetCode - Blind 75 - Reverse Bits</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/leetcode-blind-75-number-of-1-bits/">
    <span class="title">Next »</span>
    <br>
    <span>LeetCode - Blind 75 - Number of 1 Bits</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share LeetCode - Blind 75 - Counting Bits on x"
            href="https://x.com/intent/tweet/?text=LeetCode%20-%20Blind%2075%20-%20Counting%20Bits&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fleetcode-blind-75-counting-bits%2f&amp;hashtags=LeetCode%2cBlind75%2cCountingBits%2cSwift">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share LeetCode - Blind 75 - Counting Bits on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fleetcode-blind-75-counting-bits%2f&amp;title=LeetCode%20-%20Blind%2075%20-%20Counting%20Bits&amp;summary=LeetCode%20-%20Blind%2075%20-%20Counting%20Bits&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fleetcode-blind-75-counting-bits%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share LeetCode - Blind 75 - Counting Bits on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fleetcode-blind-75-counting-bits%2f&title=LeetCode%20-%20Blind%2075%20-%20Counting%20Bits">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share LeetCode - Blind 75 - Counting Bits on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fleetcode-blind-75-counting-bits%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share LeetCode - Blind 75 - Counting Bits on whatsapp"
            href="https://api.whatsapp.com/send?text=LeetCode%20-%20Blind%2075%20-%20Counting%20Bits%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fleetcode-blind-75-counting-bits%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share LeetCode - Blind 75 - Counting Bits on telegram"
            href="https://telegram.me/share/url?text=LeetCode%20-%20Blind%2075%20-%20Counting%20Bits&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fleetcode-blind-75-counting-bits%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share LeetCode - Blind 75 - Counting Bits on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=LeetCode%20-%20Blind%2075%20-%20Counting%20Bits&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fleetcode-blind-75-counting-bits%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer><div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'dmytros-blog';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Dmytro&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script>
    
    
    let b = document.querySelector("#menu-trigger")
    let m = document.querySelector(".menu")
    b.addEventListener("click", function () {
        m.classList.toggle("hidden")
    });
    
    document.body.addEventListener('click', function (event) {
        if (!b.contains(event.target)) {
            m.classList.add("hidden")
        }
    });
    
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
